// Module to expand the right 32 bits to 64 bits using a DES table

module Expansion (
      input  wire [31:0] R_in,      // 32-bit right half
      output wire [47:0] E_out      // 48-bit expanded output
);


      localparam [5:0] E_table [0:47] = {
          32, 1,  2,  3,  4,  5,
          4,  5,  6,  7,  8,  9,
          8,  9,  10, 11, 12, 13,
          12, 13, 14, 15, 16, 17,
          16, 17, 18, 19, 20, 21,
          20, 21, 22, 23, 24, 25,
          24, 25, 26, 27, 28, 29,
          28, 29, 30, 31, 32, 1
      };

      integer i;

      always @(*) begin
          for (i = 0; i < 48; i = i + 1) begin
              E_out[47-i] = R_in[32 - E_table[i]];
          end
      end

  endmodule